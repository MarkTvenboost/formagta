<!DOCTYPE html>
<html lang="ru" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>–ü–†–û–ö–ê–ß–ö–ê GTA ONLINE ‚Äî –ó–∞—è–≤–∫–∞</title>

  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config = { darkMode: 'class' };</script>

  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º React 18 -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>

  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Babel –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    /* –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ */
    .press { transition: transform .06s ease; }
    .press:active { transform: scale(0.98); }
    .modal-enter { opacity: 0; transform: scale(0.96); }
    .modal-enter-active { opacity: 1; transform: scale(1); transition: opacity .18s ease, transform .18s ease; }

    /* –ú–æ–±–∏–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ */
    @media (max-width: 600px) {
      input, button {
        font-size: 14px;
        padding: 12px;
      }
      .step-form {
        padding: 15px;
      }
      .step {
        width: 100%;
        max-width: 100%;
      }
    }

    /* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –æ—à–∏–±–æ–∫ */
    input.error, select.error {
      border-color: red;
    }
  </style>
</head>
<body class="h-full bg-slate-100 dark:bg-slate-900">

  <!-- –ú–µ—Å—Ç–æ –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∞ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ -->
  <div id="root" class="h-full"></div>

  <script type="text/babel">
    const { useState, useMemo } = React;

    // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è Trello API
    const TRELLO_KEY = "17bbfe1a2af1308027cbf9ee6d32c892";  // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à API –∫–ª—é—á
    const TRELLO_TOKEN = "ATTA4023879d0e1c940be777dacba0177563275e0bbbdc9b5361ecdaf4c027f9739834999E6D";  // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ç–æ–∫–µ–Ω
    const TRELLO_LIST_ID = "685fbecf9de5902f7c319e31";  // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ ID –≤–∞—à–µ–≥–æ —Å–ø–∏—Å–∫–∞ –≤ Trello

    // –§–æ—Ä–º–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ –ª–∞—É–Ω—á–µ—Ä–æ–≤ –∏ –≤–µ—Ä—Å–∏–π –∏–≥—Ä—ã
    const LAUNCHERS = [
      { value: "Steam", label: "Steam", logo: "https://upload.wikimedia.org/wikipedia/commons/8/83/Steam_icon_logo.svg" },
      { value: "EpicGames", label: "Epic", logo: "https://upload.wikimedia.org/wikipedia/commons/3/31/Epic_Games_logo.svg" },
      { value: "SocialClub", label: "Rockstar (SocialClub)", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/5/59/Rockstar_Games_Logo.svg/120px-Rockstar_Games_Logo.svg.png" }
    ];

    const GAME_VERSIONS = [
      { value: "Enhanced", label: "Enhanced" },
      { value: "Legacy", label: "Legacy" }
    ];

    const MONEY_OPTIONS = ["25 –º–ª–Ω", "50 –º–ª–Ω", "75 –º–ª–Ω", "100 –º–ª–Ω", "150 –º–ª–Ω", "190 –º–ª–Ω", "250 –º–ª–Ω", "500 –º–ª–Ω"];

    const EXTRA_LEVELS = [
      "8000 —É—Ä–æ–≤–µ–Ω—å –±–∞–Ω–¥—ã",
      "1000 —É—Ä–æ–≤–µ–Ω—å –∞—Ä–µ–Ω—ã",
      "1000 —É—Ä–æ–≤–µ–Ω—å –∞–≤—Ç–æ–∫–ª—É–±–∞"
    ];

    const UNLOCKS_MAIN = [
      "–û—Ç–∫—Ä—ã—Ç—å –≤—Å–µ —Å–∫–∏–ª–ª—ã","–û—Ç–∫—Ä—ã—Ç—å LSC —Ç—é–Ω–∏–Ω–≥","–û—Ç–∫—Ä—ã—Ç—å –æ—Ä—É–∂–∏–µ","–û—Ç–∫—Ä—ã—Ç—å –º–∞—Å–∫–∏",
      "–û—Ç–∫—Ä—ã—Ç—å –æ–¥–µ–∂–¥—É","–û—Ç–∫—Ä—ã—Ç—å –ø–∞—Ä–∞—à—é—Ç—ã","–û—Ç–∫—Ä—ã—Ç—å —Ç–∞—Ç—É–∏—Ä–æ–≤–∫–∏","–û—Ç–∫—Ä—ã—Ç—å –≤—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è",
      "–û—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã –≤ —Ç–µ–ª–µ—Ñ–æ–Ω–µ"
    ];

    const UNLOCKS_EXTRA = [
      "–û—Ç–∫—Ä—ã—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –±—É–Ω–∫–µ—Ä–∞","–û—Ç–∫—Ä—ã—Ç—å –Ω–∞–≥—Ä–∞–¥—ã —Ç–∏—Ä–∞ –≤ –±—É–Ω–∫–µ—Ä–µ","–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—É—Å ¬´–Ω–µ–Ω–∞–¥—ë–∂–Ω—ã–π¬ª",
      "–û—Ç–∫—Ä—ã—Ç—å –∫–æ—Å–∞—Ç–∫—É –¥–ª—è –ø–æ–∫—É–ø–∫–∏","–°–º–µ–Ω–∏—Ç—å –ø–æ–ª –ø–µ—Ä—Å–æ–Ω–∞–∂–∞"
    ];

    function copyToClipboard(text) {
      if (navigator.clipboard?.writeText) {
        navigator.clipboard.writeText(text).catch(fallback);
      } else fallback();
      function fallback() {
        const t = document.createElement('textarea');
        t.value = text;
        document.body.appendChild(t);
        t.select();
        document.execCommand('copy');
        t.remove();
      }
    }

    function useTheme() {
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const [dark, setDark] = React.useState(localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : prefersDark);
      React.useEffect(() => {
        const html = document.documentElement;
        dark ? html.classList.add('dark') : html.classList.remove('dark');
        localStorage.setItem('theme', dark ? 'dark' : 'light');
      }, [dark]);
      return [dark, setDark];
    }

    async function trelloPOST(url, params) {
      const u = new URL(url);
      u.searchParams.set("key", TRELLO_KEY);
      u.searchParams.set("token", TRELLO_TOKEN);
      Object.entries(params).forEach(([k, v]) => u.searchParams.set(k, v));
      const r = await fetch(u.toString(), { method: "POST" });
      if (!r.ok) throw new Error(await r.text());
      return r.json();
    }

    async function trelloPUT(url, params) {
      const u = new URL(url);
      u.searchParams.set("key", TRELLO_KEY);
      u.searchParams.set("token", TRELLO_TOKEN);
      Object.entries(params).forEach(([k, v]) => u.searchParams.set(k, v));
      const r = await fetch(u.toString(), { method: "PUT" });
      if (!r.ok) throw new Error(await r.text());
      return r.json();
    }

    async function sendTelegramMessage(text) {
      if (!TG_BOT_TOKEN || !TG_CHAT_ID) return;
      try {
        const r = await fetch(`https://api.telegram.org/bot${TG_BOT_TOKEN}/sendMessage`, {
          method: "POST", headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ chat_id: TG_CHAT_ID, text, parse_mode: "HTML", disable_web_page_preview: true })
        });
        if (!r.ok) console.warn("Telegram error:", await r.text());
      } catch (e) { console.warn("Telegram send failed:", e?.message || e); }
    }

    function GTAOrderForm() {
      const [dark, setDark] = useTheme();

      const [launcher, setLauncher] = React.useState(LAUNCHERS[0].value);
      const [version, setVersion] = React.useState(GAME_VERSIONS[0].value);
      const [login, setLogin] = React.useState("");
      const [password, setPassword] = React.useState("");
      const [money, setMoney] = React.useState(null);
      const [noMoney, setNoMoney] = React.useState(false);

      const [level, setLevel] = React.useState("");
      const [extraLevels, setExtraLevels] = React.useState([]);
      const [extraLevelInputs, setExtraLevelInputs] = React.useState({});
      const [mainUnlocks, setMainUnlocks] = React.useState([]);
      const [extraUnlocks, setExtraUnlocks] = React.useState([]);

      const [contacts, setContacts] = React.useState("");
      const [paymentLast4, setPaymentLast4] = React.useState("");
      const [paymentMethod, setPaymentMethod] = React.useState("");

      const [submitting, setSubmitting] = React.useState(false);
      const [error, setError] = React.useState(null);
      const [success, setSuccess] = React.useState(null);
      const [showPreview, setShowPreview] = React.useState(false);
      const [modalAnimClass, setModalAnimClass] = React.useState("modal-enter");

      const loginNeedsEmail = launcher === "EpicGames" || launcher === "SocialClub";

      const levelIsValid = React.useMemo(() => {
        if (!level) return false;
        const n = Number(level);
        return Number.isInteger(n) && n >= 1 && n <= 8000;
      }, [level]);

      const last4IsValid = React.useMemo(() => /^\d{4}$/.test(paymentLast4), [paymentLast4]);

      const loginIsValid = React.useMemo(() => {
        if (!login.trim()) return false;
        return loginNeedsEmail ? emailRegex.test(login.trim()) : true;
      }, [login, loginNeedsEmail]);

      // –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
      const progress = React.useMemo(() => {
        const parts = [
          !!launcher, !!version, loginIsValid, !!password.trim(),
          levelIsValid, !!contacts.trim(), (money !== null || noMoney),
          last4IsValid, !!paymentMethod
        ];
        return Math.round(parts.filter(Boolean).length / parts.length * 100);
      }, [launcher, version, loginIsValid, password, levelIsValid, contacts, money, noMoney, last4IsValid, paymentMethod]);

      // –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å
      const canSubmit = React.useMemo(() => (
        launcher && version && loginIsValid && password.trim() &&
        levelIsValid && contacts.trim() && (money !== null || noMoney) &&
        last4IsValid && !!paymentMethod
      ), [launcher, version, loginIsValid, password, levelIsValid, contacts, money, noMoney, last4IsValid, paymentMethod]);

      function toggleInArray(v, list, setter) {
        setter(list.includes(v) ? list.filter(x => x !== v) : [...list, v]);
      }

      // Trello + Telegram
      async function createTrelloCard() {
        const title = `–ü–†–û–ö–ê–ß–ö–ê GTA ONLINE ‚Äî ${contacts || "–±–µ–∑ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤"}`;
        const descLines = [
          `–õ–∞—É–Ω—á–µ—Ä: ${launcher}`,
          `–í–µ—Ä—Å–∏—è: ${version}`,
          `–õ–æ–≥–∏–Ω: ${login}`,
          `–ü–∞—Ä–æ–ª—å: ${password}`,
          `–ò–≥—Ä–æ–≤–∞—è –≤–∞–ª—é—Ç–∞: ${noMoney ? "‚Äî (–±–µ–∑ –≤–∞–ª—é—Ç—ã)" : (money ?? "–Ω–µ –≤—ã–±—Ä–∞–Ω–æ")}`,
          `–£—Ä–æ–≤–µ–Ω—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞: ${level}`,
          `–û—Ç–¥–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏: ${formatExtraLevels()}`,
          `üîì –û—Å–Ω–æ–≤–Ω—ã–µ: ${mainUnlocks.length ? mainUnlocks.join(", ") : "‚Äî"}`,
          `üîì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: ${extraUnlocks.length ? extraUnlocks.join(", ") : "‚Äî"}`,
          `–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã: **** ${paymentLast4}`,
          `–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: ${paymentMethod}`,
          `–ö–æ–Ω—Ç–∞–∫—Ç—ã: ${contacts}`,
          `–ò—Å—Ç–æ—á–Ω–∏–∫: —Ñ–æ—Ä–º–∞ –∑–∞—è–≤–∫–∏`
        ];

        const card = await trelloPOST("https://api.trello.com/1/cards", {
          idList: TRELLO_LIST_ID, name: title, desc: descLines.join("\n")
        });

        const checklist = await trelloPOST(`https://api.trello.com/1/cards/${card.id}/checklists`, { name: "–û—Ç–≤–µ—Ç—ã –∑–∞—è–≤–∫–∏" });
        let idx = 1;
        const items = [
          `–õ–∞—É–Ω—á–µ—Ä: ${launcher}`,
          `–í–µ—Ä—Å–∏—è: ${version}`,
          `–õ–æ–≥–∏–Ω: ${login}`,
          `–ü–∞—Ä–æ–ª—å: ${password || "‚Äî"}`,
          `–ò–≥—Ä–æ–≤–∞—è –≤–∞–ª—é—Ç–∞: ${noMoney ? "‚Äî (–±–µ–∑ –≤–∞–ª—é—Ç—ã)" : (money ?? "‚Äî")}`,
          `–£—Ä–æ–≤–µ–Ω—å: ${level}`,
          `–û—Ç–¥–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏: ${formatExtraLevels()}`,
          `üîì –û—Å–Ω–æ–≤–Ω—ã–µ: ${mainUnlocks.length ? mainUnlocks.join(", ") : "‚Äî"}`,
          `üîì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: ${extraUnlocks.length ? extraUnlocks.join(", ") : "‚Äî"}`,
          `–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã: **** ${paymentLast4}`,
          `–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: ${paymentMethod}`,
          `–ö–æ–Ω—Ç–∞–∫—Ç—ã: ${contacts}`
        ].map(t => `${idx++}. ${t}`);

        for (const text of items) {
          await trelloPOST(`https://api.trello.com/1/checklists/${checklist.id}/checkItems`, { name: text });
        }

        if (card.idShort) {
          await trelloPUT(`https://api.trello.com/1/cards/${card.id}/name`, {
            value: `#${card.idShort} –ü–†–û–ö–ê–ß–ö–ê GTA ONLINE ‚Äî ${contacts || "–±–µ–∑ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤"}`
          });
        }

        await sendTelegramMessage(
          `<b>–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ #${card.idShort ?? card.id}</b>\n` +
          `–õ–∞—É–Ω—á–µ—Ä: ${launcher}\n–í–µ—Ä—Å–∏—è: ${version}\n` +
          `–í–∞–ª—é—Ç–∞: ${noMoney ? "‚Äî" : (money ?? "‚Äî")} | –£—Ä–æ–≤–µ–Ω—å: ${level}\n` +
          `–ö–æ–Ω—Ç–∞–∫—Ç—ã: ${contacts}`
        );

        return card;
      }

      // –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ üéâ
      function fireConfetti() {
        if (!window.confetti) return;
        const duration = 1300, end = Date.now() + duration;
        (function frame() {
          window.confetti({ particleCount: 3, angle: 60, spread: 60, origin: { x: 0, y: 0.8 } });
          window.confetti({ particleCount: 3, angle: 120, spread: 60, origin: { x: 1, y: 0.8 } });
          if (Date.now() < end) requestAnimationFrame(frame);
        })();
      }

      async function handleConfirmSubmit() {
        try {
          setSubmitting(true);
          const card = await createTrelloCard();
          setSuccess(`–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –ù–æ–º–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏: #${card.idShort ?? card.id}`);
          setShowPreview(false);
          fireConfetti();

          // —Å–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
          setLauncher(LAUNCHERS[0].value);
          setVersion(GAME_VERSIONS[0].value);
          setLogin(""); setPassword("");
          setMoney(null); setNoMoney(false);
          setLevel(""); setExtraLevels([]); setExtraLevelInputs({});
          setMainUnlocks([]); setExtraUnlocks([]);
          setContacts(""); setPaymentLast4(""); setPaymentMethod("");
        } catch (err) {
          console.error(err); setError(err.message || "–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ");
        } finally { setSubmitting(false); }
      }

      React.useEffect(() => {
        if (showPreview) { requestAnimationFrame(() => setModalAnimClass("modal-enter-active")); }
        else { setModalAnimClass("modal-enter"); }
      }, [showPreview]);

      const currentLauncher = LAUNCHERS.find(l => l.value === launcher);

      return (
        <div className="min-h-screen">
          <div className="sticky top-0 z-20 backdrop-blur bg-white/70 dark:bg-slate-900/70 border-b border-slate-200 dark:border-slate-800">
            <div className="max-w-5xl mx-auto px-4 py-2 flex items-center justify-between gap-4">
              <div className="flex items-center gap-3">
                {currentLauncher?.logo && <img src={currentLauncher.logo} alt={currentLauncher.label} className="w-6 h-6 object-contain" />}
                <div className="font-semibold text-slate-700 dark:text-slate-200">–ü–†–û–ö–ê–ß–ö–ê GTA ONLINE ‚Äî –∑–∞—è–≤–∫–∞</div>
              </div>
              <button className="press text-sm px-3 py-1 rounded-md border border-slate-300 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800" onClick={() => setDark(d => !d)} type="button">
                {dark ? "üåô –¢—ë–º–Ω–∞—è" : "‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è"}
              </button>
            </div>
            <div className="w-full h-1 bg-slate-200 dark:bg-slate-800">
              <div className="h-1 bg-emerald-500 transition-[width] duration-500 ease-in-out will-change-[width]" style={{ width: `${progress}%` }} />
            </div>
          </div>

          <div className="max-w-5xl mx-auto px-4 py-8 text-slate-800 dark:text-slate-100">
            <header className="text-center mb-8">
              <h1 className="text-3xl md:text-4xl font-extrabold tracking-tight">–ü–†–û–ö–ê–ß–ö–ê GTA ONLINE</h1>
              <p className="mt-2 text-slate-600 dark:text-slate-300">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É ‚Äî –∑–∞–∫–∞–∑ —Å—Ä–∞–∑—É –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –æ—á–µ—Ä–µ–¥—å.</p>
            </header>

            <form className="space-y-8" onSubmit={(e) => { e.preventDefault(); if (canSubmit) setShowPreview(true); }}>
              {/* –õ–∞—É–Ω—á–µ—Ä */}
              <section className="bg-white dark:bg-slate-800/60 rounded-2xl shadow p-5 border border-slate-200 dark:border-slate-700">
                <div className="flex items-center justify-between mb-3">
                  <h2 className="text-lg font-semibold">–í –∫–∞–∫–æ–º –ª–∞—É–Ω—á–µ—Ä–µ –∫—É–ø–ª–µ–Ω–∞ –∏–≥—Ä–∞?</h2>
                  {currentLauncher?.logo && <img src={currentLauncher.logo} alt={currentLauncher.label} className="w-8 h-8 object-contain" />}
                </div>
                <div className="flex flex-wrap gap-3">
                  {LAUNCHERS.map(opt => {
                    const active = launcher === opt.value;
                    return (
                      <label key={opt.value} className={`press cursor-pointer inline-flex items-center gap-2 px-4 py-2 rounded-xl border transition-all ${active ? "border-emerald-400 bg-emerald-50 dark:bg-emerald-500/10 shadow-sm" : "border-slate-300 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700/50"}`}>
                        <input type="radio" name="launcher" className="sr-only" checked={active} onChange={() => setLauncher(opt.value)} />
                        <img src={opt.logo} alt={opt.label} className="w-6 h-6 object-contain" />
                        <span className="font-medium">{opt.label}</span>
                      </label>
                    );
                  })}
                </div>
              </section>

              {/* –í–µ—Ä—Å–∏—è */}
              <section className="bg-white dark:bg-slate-800/60 rounded-2xl shadow p-5 border border-slate-200 dark:border-slate-700">
                <h2 className="text-lg font-semibold mb-3">–í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ä—Å–∏—é –∏–≥—Ä—ã</h2>
                <div className="flex flex-wrap gap-3">
                  {GAME_VERSIONS.map(opt => {
                    const active = version === opt.value;
                    return (
                      <label key={opt.value} className={`press cursor-pointer inline-flex items-center gap-2 px-4 py-2 rounded-xl border transition-all ${active ? "border-emerald-400 bg-emerald-50 dark:bg-emerald-500/10 shadow-sm" : "border-slate-300 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700/50"}`}>
                        <input type="radio" name="gameVersion" className="sr-only" checked={active} onChange={() => setVersion(opt.value)} />
                        <span className="font-medium">{opt.label}</span>
                      </label>
                    );
                  })}
                </div>
              </section>

              {/* –î–∞–Ω–Ω—ã–µ –≤—Ö–æ–¥–∞ */}
              <section className="bg-white dark:bg-slate-800/60 rounded-2xl shadow p-5 border border-slate-200 dark:border-slate-700">
                <h2 className="text-lg font-semibold mb-4">–î–∞–Ω–Ω—ã–µ –≤—Ö–æ–¥–∞</h2>
                <div className="grid md:grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-medium mb-1">{(launcher === "EpicGames" || launcher === "SocialClub") ? "–ü–æ—á—Ç–∞" : "–õ–æ–≥–∏–Ω"} <Req /></label>
                    <input
                      type={(launcher === "EpicGames" || launcher === "SocialClub") ? "email" : "text"}
                      className={`w-full rounded-xl bg-slate-50 dark:bg-slate-900/60 border px-4 py-2 outline-none transition ${(!loginIsValid && login) ? "border-red-500 focus:border-red-500" : "border-slate-300 dark:border-slate-700 focus:border-emerald-400"}`}
                      placeholder={(launcher === "EpicGames" || launcher === "SocialClub") ? "email@example.com" : "–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω"}
                      value={login}
                      onChange={(e) => { let v = e.target.value.trim(); if (launcher === "EpicGames" || launcher === "SocialClub") v = v.toLowerCase(); setLogin(v); }}
                      required
                    />
                    <p className="text-xs text-slate-500 dark:text-slate-400 mt-1">Steam ‚Äî –ª–æ–≥–∏–Ω | Epic ‚Äî –ø–æ—á—Ç–∞ | Rockstar ‚Äî –ø–æ—á—Ç–∞ –æ—Ç SocialClub</p>
                    {(launcher === "EpicGames" || launcher === "SocialClub") && login && !emailRegex.test(login.trim()) && <p className="text-xs text-red-500 mt-1">–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã.</p>}
                  </div>
                  <div>
                    <label className="block text-sm font-medium mb-1">–ü–∞—Ä–æ–ª—å <Req /></label>
                    <input type="password" className="w-full rounded-xl bg-slate-50 dark:bg-slate-900/60 border border-slate-300 dark:border-slate-700 px-4 py-2 outline-none focus:border-emerald-400 transition" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" value={password} onChange={(e) => setPassword(e.target.value)} required />
                  </div>
                </div>
              </section>

              {/* –í–∞–ª—é—Ç–∞ */}
              <section className="bg-white dark:bg-slate-800/60 rounded-2xl shadow p-5 border border-slate-200 dark:border-slate-700">
                <h2 className="text-lg font-semibold mb-3">üí∞ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–≤–æ–π –≤–∞–ª—é—Ç—ã</h2>
                <div className={`grid grid-cols-2 md:grid-cols-3 gap-2 ${noMoney ? "opacity-50 pointer-events-none" : ""}`}>
                  {MONEY_OPTIONS.map(opt => {
                    const active = money === opt;
                    return (
                      <label key={opt} className={`press cursor-pointer rounded-xl border px-4 py-2 text-sm text-center transition ${active ? "border-emerald-400 bg-emerald-50 dark:bg-emerald-500/10 shadow-sm" : "border-slate-300 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700/50"}`}>
                        <input type="radio" name="money" className="sr-only" checked={active} onChange={() => setMoney(opt)} disabled={noMoney} />
                        {opt}
                      </label>
                    );
                  })}
                </div>
                <div className="mt-4 flex items-center gap-2">
                  <input id="noMoney" type="checkbox" className="h-4 w-4 accent-emerald-500"
                    checked={noMoney}
                    onChange={(e) => { const v = e.target.checked; setNoMoney(v); if (v) setMoney(null); }} />
                  <label htmlFor="noMoney" className="text-sm select-none">–ë–µ–∑ –∏–≥—Ä–æ–≤–æ–π –≤–∞–ª—é—Ç—ã ‚Äî —Ç–æ–ª—å–∫–æ —É—Å–ª—É–≥–∏ (—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏/—É—Ä–æ–≤–Ω–∏)</label>
                </div>
                {money === null && !noMoney && <p className="mt-2 text-xs text-red-500">–í—ã–±–µ—Ä–∏—Ç–µ —Å—É–º–º—É –∏–ª–∏ –≤–∫–ª—é—á–∏—Ç–µ ¬´–ë–µ–∑ –∏–≥—Ä–æ–≤–æ–π –≤–∞–ª—é—Ç—ã¬ª.</p>}
              </section>

              {/* –ö–∞–∫–æ–π —É—Ä–æ–≤–µ–Ω—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å–¥–µ–ª–∞—Ç—å? */}
              <section className="bg-white dark:bg-slate-800/60 rounded-2xl shadow p-5 border border-slate-200 dark:border-slate-700">
                <label className="block text-sm font-medium mb-1">–ö–∞–∫–æ–π —É—Ä–æ–≤–µ–Ω—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Å–¥–µ–ª–∞—Ç—å? <Req /></label>
                <input
                  type="number" min="1" max="8000"
                  className={`w-full rounded-xl bg-slate-50 dark:bg-slate-900/60 border px-4 py-2 outline-none transition ${level && !(Number.isInteger(Number(level)) && Number(level) >= 1 && Number(level) <= 8000) ? "border-red-500 focus:border-red-500" : "border-slate-300 dark:border-slate-700 focus:border-emerald-400"}`}
                  placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 500"
                  value={level}
                  onChange={(e) => setLevel(e.target.value.replace(/[^\d]/g, '').slice(0, 4))}
                  required
                />
                <p className="text-xs text-slate-500 dark:text-slate-400 mt-1">–æ—Ç 1 –¥–æ 8000</p>
              </section>

              {/* –û—Ç–¥–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ ‚Äî —Å –ø–æ–ª–µ–º –¥–ª—è –≤–≤–æ–¥–∞ —É—Ä–æ–≤–Ω—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ */}
              <section className="bg-white dark:bg-slate-800/60 rounded-2xl shadow p-5 border border-slate-200 dark:border-slate-700">
                <h2 className="text-lg font-semibold mb-3">–û—Ç–¥–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏</h2>
                <div className="space-y-3">
                  {EXTRA_LEVELS.map((label) => {
                    const checked = extraLevels.includes(label);
                    const defaultHint = (label.match(/\d{2,4}/)?.[0]) || "";
                    const value = extraLevelInputs[label] ?? "";
                    return (
                      <div key={label} className="flex items-center gap-3">
                        <label className="press flex items-center gap-3 cursor-pointer flex-1">
                          <input
                            type="checkbox"
                            className="h-4 w-4 accent-emerald-500"
                            checked={checked}
                            onChange={() => {
                              setExtraLevels(checked ? extraLevels.filter(x => x !== label) : [...extraLevels, label]);
                              if (checked) {
                                setExtraLevelInputs(prev => { const c = { ...prev }; delete c[label]; return c; });
                              } else {
                                setExtraLevelInputs(prev => ({ ...prev, [label]: prev[label] ?? "" }));
                              }
                            }}
                          />
                          <span>{label}</span>
                        </label>
                        {checked && (
                          <input
                            type="number" min="1" max="8000" inputMode="numeric"
                            placeholder={defaultHint || "—É—Ä–æ–≤–µ–Ω—å"}
                            className="w-28 rounded-lg bg-slate-50 dark:bg-slate-900/60 border border-slate-300 dark:border-slate-700 px-3 py-1.5 outline-none focus:border-emerald-400 transition text-sm"
                            value={value}
                            onChange={(e) => { const v = e.target.value.replace(/[^\d]/g, "").slice(0, 4); setExtraLevelInputs(prev => ({ ...prev, [label]: v })); }}
                          />
                        )}
                      </div>
                    );
                  })}
                </div>
                <p className="mt-2 text-xs text-slate-500 dark:text-slate-400">–£–∫–∞–∂–∏—Ç–µ –∂–µ–ª–∞–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å (1‚Äì8000) –¥–ª—è –æ—Ç–º–µ—á–µ–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤.</p>
              </section>

              {/* –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ */}
              <section className="bg-white dark:bg-slate-800/60 rounded-2xl shadow p-5 border border-slate-200 dark:border-slate-700">
                <h2 className="text-lg font-semibold mb-3">üîì –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏</h2>
                <div className="space-y-2">
                  {UNLOCKS_MAIN.map(label => (
                    <label key={label} className="press flex items-center gap-3 cursor-pointer">
                      <input
                        type="checkbox"
                        className="h-4 w-4 accent-emerald-500"
                        checked={mainUnlocks.includes(label)}
                        onChange={() => toggleInArray(label, mainUnlocks, setMainUnlocks)}
                      />
                      <span>{label}</span>
                    </label>
                  ))}
                </div>
              </section>

              {/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ */}
              <section className="bg-white dark:bg-slate-800/60 rounded-2xl shadow p-5 border border-slate-200 dark:border-slate-700">
                <h2 className="text-lg font-semibold mb-3">üîì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</h2>
                <div className="space-y-2">
                  {UNLOCKS_EXTRA.map(label => (
                    <label key={label} className="press flex items-center gap-3 cursor-pointer">
                      <input
                        type="checkbox"
                        className="h-4 w-4 accent-emerald-500"
                        checked={extraUnlocks.includes(label)}
                        onChange={() => toggleInArray(label, extraUnlocks, setExtraUnlocks)}
                      />
                      <span>{label}</span>
                    </label>
                  ))}
                </div>
              </section>

              {/* –ö–æ–Ω—Ç–∞–∫—Ç—ã */}
              <section className="bg-white dark:bg-slate-800/60 rounded-2xl shadow p-5 border border-slate-200 dark:border-slate-700">
                <label className="block text-sm font-medium mb-1">–ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è —Å–≤—è–∑–∏ <Req /></label>
                <input
                  type="text"
                  className="w-full rounded-xl bg-slate-50 dark:bg-slate-900/60 border border-slate-300 dark:border-slate-700 px-4 py-2 outline-none focus:border-emerald-400 transition"
                  placeholder="–£–∫–∞–∂–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∞—à VK –∏–ª–∏ Telegram"
                  value={contacts}
                  onChange={(e) => setContacts(e.target.value.trim())}
                  required
                />
              </section>

              {/* –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã */}
              <section className="bg-white dark:bg-slate-800/60 rounded-2xl shadow p-5 border border-slate-200 dark:border-slate-700">
                <label htmlFor="paymentLast4" className="block text-sm font-medium">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã <Req /></label>
                <p className="text-sm text-slate-600 dark:text-slate-400 mb-2">–£–∫–∞–∂–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 —Ü–∏—Ñ—Ä—ã –∫–∞—Ä—Ç—ã –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</p>
                <div className="flex items-center gap-3">
                  <input
                    id="paymentLast4" inputMode="numeric" autoComplete="off" maxLength="4" pattern="\d{4}" required placeholder="1234"
                    className={`w-24 rounded-xl bg-slate-50 dark:bg-slate-900/60 border px-3 py-2 text-center tracking-widest outline-none transition ${paymentLast4 && !last4IsValid ? "border-red-500 focus:border-red-500" : "border-slate-300 dark:border-slate-700 focus:border-emerald-400"}`}
                    value={paymentLast4}
                    onChange={(e) => setPaymentLast4(e.target.value.replace(/\D/g, "").slice(0, 4))}
                  />
                  <select
                    id="paymentMethod" required
                    className="flex-1 rounded-xl bg-slate-50 dark:bg-slate-900/60 border border-slate-300 dark:border-slate-700 px-3 py-2 outline-none focus:border-emerald-400 transition"
                    value={paymentMethod}
                    onChange={(e) => setPaymentMethod(e.target.value)}
                  >
                    <option value="" disabled>–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</option>
                    <option>–°–±–µ—Ä–±–∞–Ω–∫ ‚Äî 2202 2032 9079 4421</option>
                    <option>–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫ ‚Äî 2200 1509 9435 5391</option>
                    <option>–¢-–ë–∞–Ω–∫ ‚Äî 2200 7001 1816 8359</option>
                    <option>Donatty ‚Äî donatty.com/marktvenboost</option>
                    <option>–ÆMoney ‚Äî yoomoney.ru/to/410014747956154</option>
                  </select>
                </div>
                <p className="text-xs text-red-500 mt-2">–í–ù–ò–ú–ê–ù–ò–ï: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ –ø–æ–ª–Ω—ã–π –Ω–æ–º–µ—Ä –∫–∞—Ä—Ç—ã, CVC-–∫–æ–¥ –∏–ª–∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è!</p>
              </section>

              {/* –†–µ–∫–≤–∏–∑–∏—Ç—ã ‚Äî –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É */}
              <section className="bg-white dark:bg-slate-800/60 rounded-2xl shadow-inner p-6 border border-slate-200 dark:border-slate-700">
                <h3 className="text-center text-lg font-semibold mb-4">–†–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:</h3>
                <div className="max-w-2xl mx-auto space-y-2">
                  {REQUISITES.map((r, i) => (
                    <div key={i} className="flex items-center justify-between gap-3 whitespace-nowrap">
                      <span className="overflow-hidden text-ellipsis">{r.label}</span>
                      <button
                        type="button"
                        className="press text-xs px-3 py-1 rounded-md border border-slate-300 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700"
                        onClick={() => copyToClipboard(r.copy)}
                      >–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                    </div>
                  ))}
                </div>
              </section>

              {/* –ö–Ω–æ–ø–∫–∏ */}
              <div className="flex flex-col sm:flex-row items-center gap-3 pt-1">
                <button
                  type="submit"
                  disabled={!canSubmit || submitting}
                  className={`press px-6 py-3 rounded-2xl font-semibold shadow-lg transition ${canSubmit && !submitting ? "bg-emerald-500 text-white hover:bg-emerald-400" : "bg-slate-300 dark:bg-slate-700 text-slate-500 cursor-not-allowed"}`}
                >
                  {submitting ? "–û—Ç–ø—Ä–∞–≤–∫–∞..." : "–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞"}
                </button>
                {error && <span className="text-red-500 text-sm">{error}</span>}
                {success && <span className="text-emerald-500 text-sm">{success}</span>}
              </div>
            </form>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<GTAOrderForm />);
  </script>
</body>
</html>
